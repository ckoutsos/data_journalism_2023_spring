---
title: "Reverse Engineering Project"
author: "Caroline and Khushboo"
date: "March 4, 2023"
output:
  html_document:
    theme: cerulean
    highlight: pygments
    toc: true
    toc_float:
      collapsed: true
      smooth_scroll: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Introduction 

In this notebook, we are reverse engineering the story, [STORY NAME](STORY URL)

## Load libraries

Loading required libraries for this analysis.

```{r echo=FALSE, message=FALSE}
library(tidyverse)
library(lubridate)
library(janitor)
library(dplyr)

```

## Load and Cleaning Data

In this section, describe the source of the data, write a basic data dictionary for data you are working with, and discuss any caveats or issues you discovered working with this data. 

```{r}
# Load required data

political_donos <- read_csv("data/sports-political-donations.csv")

# Path to data should be loaded from folder "data" i.e. read_csv("data/name_of_data.csv")

# Clean required data and prepare for analysis if needed. 

donos_clean <- political_donos %>%
  clean_names() %>%
 mutate(amount = as.numeric(gsub("[\\$,]", "",amount)))


```

## Sentences to Engineer
In this notebook, we are reverse engineering five sentences from the story.

### Sentence 1

* **Sentence text**: [“Of the 160 owners and commissioners in ESPN’s database, 74 contributed a majority of their publicly searchable funds to Republican campaigns, with 48 donating a majority to Democrats and the rest sending most of their money to causes that aren’t fully aligned with either party.”]

* **Analysis summary**: [Write up two to three sentences describing the results of your analysis.  Were you able to confirm the finding? If not, why not?] I think the data is rounded a bit based on what we found here. For example, we had 158 donors and he said there were 160. All of our values were slightly less or slightly more. Overall, our reverse engineered sentence is slightly off, and I think this could be because there's a couple of donors missing in our count for some reason? I'm not sure how I'd find who exactly is missing because we got the exact data from GitHub but it would be interesting to go into detail as to where exactly we went off. Perhaps the data has changed since the article was written. After all, it was published in 2020. 

```{r}
# Put code to reverse engineer sentence here

dono_count <- donos_clean %>%
  group_by(owner, party) %>%
  summarise(tot_dono = sum(amount)) %>%
  pivot_wider(names_from = party, values_from = tot_dono) %>%
  replace(is.na(.), 0) %>%
  clean_names()

dono_count$top_party = colnames(dono_count)[apply(dono_count,1,which.max)]

count_republican <- dono_count %>%
  filter(str_detect(top_party, "republican")) %>%
  nrow()

count_democrat <- dono_count %>%
  filter(str_detect(top_party, "democrat")) %>%
  nrow()

count_other <- dono_count %>%
  filter(!(top_party == "democrat" | top_party == "republican")) %>%
  nrow()

donor_count <- donos_clean %>%
  distinct(owner) %>%
  nrow()

count_republican
count_democrat
count_other
donor_count

# Display results of code below this codeblock

```

### Sentence 2

* **Sentence text**: “But while that overall summary is interesting, a more pronounced signal begins to emerge when we look more closely at this group’s larger political donations. There are 40 owners who have donated at least $100,000 to Republican causes over the six-year period, compared to 23 owners topping $100,000 to Democrats, helping lead to these splits:”

* **Analysis summary**: [Write up two to three sentences describing the results of your analysis.  Were you able to confirm the finding? If not, why not?] We found that the amount of owners that gave money to democrats was 22, and the amount donating to republicans was 37. This is slightly off, considering he found there to be 40 owners for Republican donations and 23 owners for Democrat donations for at least 100,000 dollars. 

```{r}
# Put code to reverse engineer sentence here

larger_donos <- donos_clean %>%
  group_by(owner, party) %>%
  summarise(tot_dono = sum(amount)) %>%
  filter(tot_dono >= 100000)

large_republican <- larger_donos %>%
  filter(party == "Republican") %>%
  nrow()

large_democrat <- larger_donos %>%
  filter(party == "Democrat") %>%
  nrow()

large_republican
large_democrat

# Display results of code below this codeblock

```

### Sentence 3

* **Sentence text**: “Overall, 51.7 percent of all contributions by WNBA owners went to Democrats, with 42.3 percent going to Republicans. And of the $1.3 million contributed by WNBA owners to Republicans, 65.5 percent comes from Kelly Loeffler, the Republican from Georgia who is co-owner of the Atlanta Dream.”

* **Analysis summary**: [Write up two to three sentences describing the results of your analysis.  Were you able to confirm the finding? If not, why not?] We found that we agreed with the author's findings with accuracy. Our percentages mirrored that of the sentence exactly. 

```{r}
# Put code to reverse engineer sentence here

wnba_donos <- donos_clean %>%
filter(str_detect(league, "WNBA")) %>%
group_by(owner, party) %>%
  summarise(total_donos = sum(amount))

wnba_by_party <- wnba_donos %>%
  group_by(party) %>%
  summarise(donos = sum(total_donos)) %>%
  mutate(percent = donos/(sum(donos))*100)

wnba_republican <- wnba_donos %>%
  filter(party == "Republican") %>%
  summarise(total_donos) %>%
  mutate(percent = total_donos/(sum(total_donos))*100)

# Display results of code below this codeblock

```

### Sentence 4

* **Sentence text**: “A relatively small group of donors makes up a huge chunk of the overall donation data. Forty owners account for more than $40 million — more than 85 percent of all contributions. And looking specifically at these big spenders, it’s clear where their allegiances lie: 77.7 percent of that $40 million went to Republican causes or candidates, with 18.8 percent going to Democrats.”

* **Analysis summary**: First sentence is correct (41 mill). We were able to find a close percentage to the amount from the 40 million going to either Republican or Democrat causes, but they were still not the exact numbers from the article. We tried adding in the top sums from bipartisan but mostly Republican/Democratic to see if it would make a difference, but it was not significant enough so we included it just in case. We also found that the top percent of contributions was indeed over 85, it was 88.9. Overall, we could not say for certainty that the author's numbers were ones that we found, with our numbers being slightly off. He found 77.7% and 18.8%, whereas we found 20.8% and 75.8%

```{r}
# Put code to reverse engineer sentence here

total_donos <- donos_clean %>%
  group_by(owner) %>%
  summarise(
    tot_donos = sum(amount)
  ) %>%
  arrange(desc(tot_donos)) %>%
  head(40)

top_sum = sum(total_donos$tot_donos)
sum_all = sum(donos_clean$amount)
top_percent = top_sum/sum_all*100

top_dono_distribution <- total_donos %>%
  left_join(dono_count, by =c("owner"))

# Finding sum and percentages of the democratic and republican spending by the owners. 

sum_dem = sum(top_dono_distribution$democrat) # + sum(top_dono_distribution$bipartisan_but_mostly_democratic)
percent_dem = sum_dem/top_sum*100
sum_rep = sum(top_dono_distribution$republican) # + sum(top_dono_distribution$bipartisan_but_mostly_republican)
percent_rep = sum_rep/top_sum*100

# Display results of code below this codeblock

top_sum
percent_dem
percent_rep

```

### Sentence 5

* **Sentence text**: “And when we isolate just the big-ticket donations topping $100,000 from this group, a familiar picture emerges. More than 63 percent of the $47 million in the database of nearly 3,000 contributions comes from just 108 donations split among these 40 owners — and 79 percent of that money went to Republican causes.”

* **Analysis summary**: We found that 62%, not 63% of the 47 million in the database comes from top donors. We tried to see if there were smaller donations that added up to 100000 were being made, not *donations of over 100,000 made by top 40 owners (singular), but we still got 104 donations not 108. 

```{r}
# Put code to reverse engineer sentence here

top_filter <- donos_clean %>%
  inner_join(total_donos, by = "owner") %>%
  # Tried group donations made by one owner in one year to one recipient, but results were the same
  # group_by(owner, election_year, recipient) %>%
  # summarise(dono_pool = sum(amount)) %>%
  # filter(dono_pool >= 10000)
  
filter(amount >= 10000)

big_donos_sum = sum(top_filter$amount)
big_percent = big_donos_sum/sum_all*100
big_count = nrow(top_filter)

top_republican <- top_filter %>%
  filter(party == "Republican")

sum_republican_top = sum(top_republican$amount)
percent_rep_top = sum_republican_top/big_donos_sum * 100


# Display results of code below this codeblock
big_percent
big_count
percent_rep_top

```

-30-